library(xgboost)
library(tidyverse)
library(ggplot2)
library(GGally)
ggcorr(data2,label = T,palette = "RdBu",name = "cor")
ggcorr(data2,label = F,palette = "RdBu",name = "cor")
view(data2)
data2 = data2[,-45]
ggcorr(data2,label = F,palette = "RdBu",name = "cor")
str(data2)
library(caret)
library(xgboost)
library(tidyverse)
library(ggplot2)
library(GGally)
Train<-Train <- read_csv("D:/codebase/malawi zindi/Train.csv")
dim(Train)
test <- read_csv("D:/codebase/malawi zindi/test.csv")
dim(test)
data2<-cbind(test[,-3],Train)
data2 = data2[,-c(45,23)]
str(data2)
ggcorr(data2,label = F,palette = "RdBu",name = "cor")
Train = Train[,-c(3,23]
Train = Train[,-c(3,23])
Train = Train[,-c(3,23)]
dtrain<-xgd.DMatrix(as.matrix())
library(caret)
library(xgboost)
library(tidyverse)
library(ggplot2)
library(GGally)
dtrain<-xgd.DMatrix(as.matrix())
library(Matrix)
dtrain<-xgd.DMatrix(as.matrix())
dtrain<-xgb.DMatrix(as.matrix())
dtrain<-xgb.DMatrix(as.matrix(Train))
view(Train)
test= test[,-c(3,23)]
dtest<-xgb.DMatrix(as.matrix(test))
library(caret)
library(xgboost)
library(tidyverse)
library(ggplot2)
library(GGally)
Train<-Train <- read_csv("D:/codebase/malawi zindi/Train.csv")
dim(Train)
test <- read_csv("D:/codebase/malawi zindi/test.csv")
dim(test)
data2<-cbind(test[,-3],Train)
dim(data2)
view(data2)
data2 = data2[,-c(45,23)]
str(data2)
ggcorr(data2,label = F,palette = "RdBu",name = "cor")
datax<-c("")
Train1 = Train[,-c(3,23)]
#view(Train)
test1= test[,-c(3,23)]
library(Matrix)
dtrain<-xgb.DMatrix(as.matrix(Train1))
dtest<-xgb.DMatrix(as.matrix(test1))
y_train<-test[,3]
xgb.params<-list(
colsample_bytree = 0.7,
)
xgb.params<-list(
colsample_bytree = 0.7,
subsample =0.7,
max_depth = 5,
booster = "gbtree",
eval_metric = "rsme",
objective = "reg:linear",
gamma = 0
)
gd_dt = xgb.train(xgb.params,dtrain,nrounds = 54)
xgb.params<-list(
colsample_bytree = 0.7,
subsample =0.7,
max_depth = 5,
booster = "gbtree",
#eval_metric = "rsme",
objective = "reg:linear",
gamma = 0
)
gd_dt = xgb.train(xgb.params,dtrain,nrounds = 54)
library(caret)
library(xgboost)
library(tidyverse)
library(ggplot2)
library(GGally)
Train<-Train <- read_csv("D:/codebase/malawi zindi/Train.csv")
dim(Train)
test <- read_csv("D:/codebase/malawi zindi/test.csv")
dim(test)
data2<-cbind(test[,-3],Train)
dim(data2)
view(data2)
data2 = data2[,-c(45,23)]
str(data2)
ggcorr(data2,label = F,palette = "RdBu",name = "cor")
datax<-c("")
ggduo(data2,,columnsX = )
Train1 = Train[,-c(3,23)]
#view(Train)
test1= test[,-c(3,23)]
library(Matrix)
xg
dtrain<-xgb.DMatrix(as.matrix(Train1))
dtest<-xgb.DMatrix(as.matrix(test1))
y_train<-test[,3]
xgb.params<-list(
colsample_bytree = 0.7,
subsample =0.7,
max_depth = 5,
booster = "gbtree",
#eval_metric = "rsme",
objective = "reg:linear",
gamma = 0
)
gd_dt = xgb.train(xgb.params,dtrain,nrounds = 54)
library(caret)
library(xgboost)
library(tidyverse)
library(ggplot2)
library(GGally)
Train<-Train <- read_csv("D:/codebase/malawi zindi/Train.csv")
dim(Train)
test <- read_csv("D:/codebase/malawi zindi/test.csv")
Train<-Train <- read_csv("D:/codebase/malawi zindi/Train.csv")
dim(Train)
test <- read_csv("D:/codebase/malawi zindi/test.csv")
dim(test)
names(Train)<-c("x","y","target_2015","elevation","prec1","prec2","prec3","prec4","prec5","prec6","prec7","prec8","prec6",
"prec10","prec11","prec12","prec13","prec14","prec15","prec16","prec17","Lc_mode","Square_ID  ")
names(Train)
test <- read_csv("D:/codebase/malawi zindi/test.csv")
dim(test)
names(test)<-c("x","y","target_2015","elevation","prec1","prec2","prec3","prec4","prec5","prec6","prec7","prec8","prec6",
"prec10","prec11","prec12","prec13","prec14","prec15","prec16","prec17","Lc_mode","Square_ID  ")
colSums(is.na(Train))
colSums(is.na(test))
view(Train)
view(test)
#dim(data2)
#view(data2)
#data2 = data2[,-c(45,23)]
#str(data2)
ggcorr(Train,label = F,palette = "RdBu",name = "cor")
ggcorr(test,label = F,palette = "RdBu",name = "Cor")
Train1 = Train[,-c(3,23)]
#view(Train)
test1= test[,-c(3,23)]
library(Matrix)
xg
dtrain<-xgb.DMatrix(as.matrix(Train1))
dtest<-xgb.DMatrix(as.matrix(test1))
y_train<-test[,3]
xgb.params<-list(
colsample_bytree = 0.7,
subsample =0.7,
max_depth = 5,
booster = "gbtree",
#eval_metric = "rsme",
objective = "reg:linear",
gamma = 0
)
gd_dt = xgb.train(xgb.params,dtrain,nrounds = 54)
library(caret)
library(xgboost)
library(tidyverse)
library(ggplot2)
library(GGally)
Train<-Train <- read_csv("D:/codebase/malawi zindi/Train.csv")
dim(Train)
test <- read_csv("D:/codebase/malawi zindi/test.csv")
dim(test)
names(Train)<-c("x","y","target_2015","elevation","prec1","prec2","prec3","prec4","prec5","prec6","prec7","prec8","prec6",
"prec10","prec11","prec12","prec13","prec14","prec15","prec16","prec17","Lc_mode","Square_ID  ")
names(Train)
names(test)<-c("x","y","target_2015","elevation","prec1","prec2","prec3","prec4","prec5","prec6","prec7","prec8","prec6",
"prec10","prec11","prec12","prec13","prec14","prec15","prec16","prec17","Lc_mode","Square_ID  ")
colSums(is.na(Train))
colSums(is.na(test))
view(Train)
view(test)
#dim(data2)
#view(data2)
#data2 = data2[,-c(45,23)]
#str(data2)
ggcorr(Train,label = F,palette = "RdBu",name = "cor")
ggcorr(test,label = F,palette = "RdBu",name = "Cor")
Train1 = Train[,-c(3,23)]
#view(Train)
test1= test[,-c(3,23)]
library(Matrix)
xg
dtrain<-xgb.DMatrix(as.matrix(Train1))
dtest<-xgb.DMatrix(as.matrix(test1))
y_train<-test[,3]
bst<-xgboost(data = dtrain,
label = y_train,max_depth =4,eta = 1,nthread = 2,nrounds = 10,objective = "reg:linear")
y_train
bst<-xgboost(data = dtrain,
label =as.numeric( y_train),max_depth =4,eta = 1,nthread = 2,nrounds = 10,objective = "reg:linear")
Train<-Train <- read_csv("D:/codebase/malawi zindi/Train.csv")
dim(Train)
test <- read_csv("D:/codebase/malawi zindi/test.csv")
dim(test)
names(Train)<-c("x","y","target_2015","elevation","prec1","prec2","prec3","prec4","prec5","prec6","prec7","prec8","prec6",
"prec10","prec11","prec12","prec13","prec14","prec15","prec16","prec17","Lc_mode","Square_ID  ")
names(Train)
names(test)<-c("x","y","target_2015","elevation","prec1","prec2","prec3","prec4","prec5","prec6","prec7","prec8","prec6",
"prec10","prec11","prec12","prec13","prec14","prec15","prec16","prec17","Lc_mode","Square_ID  ")
colSums(is.na(Train))
colSums(is.na(test))
view(Train)
view(test)
#dim(data2)
#view(data2)
#data2 = data2[,-c(45,23)]
#str(data2)
ggcorr(Train,label = F,palette = "RdBu",name = "cor")
ggcorr(test,label = F,palette = "RdBu",name = "Cor")
Train1 = Train[,-c(3,23)]
#view(Train)
test1= test[,-c(3,23)]
library(Matrix)
xg
#dtrain<-xgb.DMatrix(as.matrix(Train1)),label = target_2015
#dtest<-xgb.DMatrix(as.matrix(test1))
y_train<-test[,3]
y_train
library(caret)
library(xgboost)
library(tidyverse)
library(ggplot2)
library(GGally)
Train<-Train <- read_csv("D:/codebase/malawi zindi/Train.csv")
dim(Train)
test <- read_csv("D:/codebase/malawi zindi/test.csv")
dim(test)
names(Train)<-c("x","y","target_2015","elevation","prec1","prec2","prec3","prec4","prec5","prec6","prec7","prec8","prec6",
"prec10","prec11","prec12","prec13","prec14","prec15","prec16","prec17","Lc_mode","Square_ID  ")
names(Train)
names(test)<-c("x","y","target_2015","elevation","prec1","prec2","prec3","prec4","prec5","prec6","prec7","prec8","prec6",
"prec10","prec11","prec12","prec13","prec14","prec15","prec16","prec17","Lc_mode","Square_ID  ")
colSums(is.na(Train))
colSums(is.na(test))
view(Train)
view(test)
#dim(data2)
#view(data2)
#data2 = data2[,-c(45,23)]
#str(data2)
ggcorr(Train,label = F,palette = "RdBu",name = "cor")
ggcorr(test,label = F,palette = "RdBu",name = "Cor")
Train1 = Train[,-c(3,23)]
#view(Train)
test1= test[,-c(3,23)]
dtrain <- xgb.DMatrix(as.matrix(Train),
label = as.numeric(Train$target_2015))
Train1 = Train[,-23)]
Train1 = Train[,-23]
#view(Train)
test1= test[,-23)]
#view(Train)
test1= test[,-23]
dtrain <- xgb.DMatrix(as.matrix(Train1),
label = as.numeric(Train1$target_2015))
dtest <- xgb.DMatrix(as.matrix(test1),
label = as.numeric(test1$target_2015))
params <- list(max_depth = 3,
objective = "reg:linear",
silent = 0)
watchlist <- list(train = dtrain, eval = dtest)
library(xgboost)
xgboost_model <- xgboost(data = as.matrix(Train1),
label = as.numeric(Train1$target_2015),
max_depth = 3,
objective = "reg:linear",
nrounds = 10,
verbose = FALSE,
prediction = TRUE)
xgboost_model
predict(xgboost_model,
as.matrix(test1)) %>%
as_tibble() %>%
mutate(prediction = round(value),
label = as.numeric(test_data$Outcome)) %>%
count(prediction, label)
predict(xgboost_model,
as.matrix(test1)) %>%
as.tibble() %>%
mutate(prediction = round(value),
label = as.numeric(test1$target_2015)) %>%
count(prediction, label)
predict(xgboost_model,
as.matrix(test1)) %>%
as.tibble() %>%
mutate(prediction = value,
label = as.numeric(test1$target_2015)) %>%
count(prediction, label)
predict(xgboost_model,
as.matrix(test1)) %>%
as.tibble() %>%
mutate(prediction = value,
label = as.numeric(test1$target_2015)) %>%
count(prediction, label)%>%
mean(prediction==test1$target_2015)
target_2019 = predict(xgboost_model,
as.matrix(test1))
target_2019
test[,23]%>%
mutate(y = target_2019)%>%
write.csv("SampleSubmission.csv")
test[,23]%>%
mutate(y = target_2019)%>%
write.csv("SampleSubmission.csv")%>%
read.csv("SampleSubmission.csv")
test[,23]%>%
mutate(y = target_2019)%>%
write.csv(file = "SampleSubmission.csv")%>%
read.csv("SampleSubmission.csv")
test[,23]%>%
write.csv(file = "SampleSubmission.csv")%>%
test[,23]%>%
write.csv(file = "SampleSubmission.csv")%>%
read_csv("SampleSubmission.csv",col_names = T)
test[,23]%>%
write.csv(file = "SampleSubmission.csv")
read.csv("SampleSubmission.csv",header = T)
sub<-cbind(test[,23],target_2019)
write.csv(sub,file = "SubmissionFile.csv",row.names = F)
SubmissionFile.csv<-read.csv("SubmissionFile.csv",header = T)
view(SubmissionFile.csv)
library(caret)
library(xgboost)
library(tidyverse)
library(ggplot2)
library(GGally)
view(SubmissionFile.csv)
Square_ID = test[,23]
sub<-cbind(Square_ID,target_2019)
write.csv(sub,file = "SubmissionFile.csv",row.names = F)
SubmissionFile.csv<-read.csv("SubmissionFile.csv",header = T)
view(SubmissionFile.csv)
Square_ID= test[,23]
sub<-cbind(Square_ID,target_2019)
write.csv(sub,file = "SampleSubmission.csv",row.names = F)
SampleSubmission.csv<-read.csv("SampleSubmission.csv",header = T)
view(SampleSubmission.csv)
sub<-cbind(Square_ID,round(target_2019,3))
write.csv(sub,file = "SampleSubmission.csv",row.names = F)
SampleSubmission.csv<-read.csv("SampleSubmission.csv",header = T)
view(SampleSubmission.csv)
target_2019 = round(predict(xgboost_model,
as.matrix(test1)),3)
target_2019
Square_ID= test[,23]
sub<-cbind(Square_ID,target_2019)
write.csv(sub,file = "SampleSubmission.csv",row.names = F)
SampleSubmission.csv<-read.csv("SampleSubmission.csv",header = T)
view(SampleSubmission.csv)
```
```{r}
library(readr)
SampleSubmission <- read_csv("SampleSubmission.csv")
View(SampleSubmission)
library(xgboost)
xgboost_model <- xgboost(data = as.matrix(Train1),
label = as.numeric(Train1$target_2015),
max_depth = 3,
objective = "reg:linear",
nrounds = 10,
verbose = FALSE,
prediction = TRUE)
xgboost_model
summary(xgboost_model)
xgboost_model <- xgboost(data = as.matrix(Train1),
label = as.numeric(Train1$target_2015),
max_depth = 6,
objective = "reg:linear",
nrounds = 9,
verbose = FALSE,
prediction = TRUE)
xgboost_model
xgboost_model <- xgboost(data = as.matrix(Train1),
label = as.numeric(Train1$target_2015),
max_depth = 7,
objective = "reg:linear",
nrounds = 9,
verbose = FALSE,
prediction = TRUE)
xgboost_model
summary(xgboost_model)
target_2019 = round(predict(xgboost_model,
as.matrix(test1)),3)
target_2019
Square_ID= test[,23]
sub<-cbind(Square_ID,target_2019)
write.csv(sub,file = "SampleSubmission.csv",row.names = F)
SampleSubmission.csv<-read.csv("SampleSubmission.csv",header = T)
view(SampleSubmission.csv)
library(xgboost)
xgboost_model <- xgboost(data = as.matrix(Train1),
label = as.numeric(Train1$target_2015),
max_depth = 7,
objective = "reg:linear",
nrounds = 54,
verbose = FALSE,
prediction = TRUE)
xgboost_model
summary(xgboost_model)
target_2019 = round(predict(xgboost_model,
as.matrix(test1)),3)
target_2019
xgboost_model <- xgboost(data = as.matrix(Train1),
label = as.numeric(Train1$target_2015),
max_depth = 3,
objective = "reg:linear",
nrounds = 10,
verbose = FALSE,
prediction = TRUE)
xgboost_model
summary(xgboost_model)
target_2019 = round(predict(xgboost_model,
as.matrix(test1)),3)
target_2019
Square_ID= test[,23]
sub<-cbind(Square_ID,target_2019)
write.csv(sub,file = "SampleSubmission.csv",row.names = F)
SampleSubmission.csv<-read.csv("SampleSubmission.csv",header = T)
view(SampleSubmission.csv)
```
```{r}
library(readr)
SampleSubmission <- read_csv("SampleSubmission.csv")
View(SampleSubmission)
Square_ID= test[,23]
sub<-cbind(Square_ID,target_2019)
write.csv(sub,file = "SampleSubmission.csv",row.names = F)
SampleSubmission.csv<-read.csv("SampleSubmission.csv",header = T)
view(SampleSubmission.csv)
```
library(readr)
SampleSubmission <- read_csv("SampleSubmission.csv")
View(SampleSubmission)
dtrain <- xgb.DMatrix(as.matrix(Train1),
label = as.numeric(Train1$target_2015))
dtest <- xgb.DMatrix(as.matrix(test1),
label = as.numeric(test1$target_2015))
params <- list(max_depth = 3,
objective = "reg:linear",
silent = 0)
watchlist <- list(train = dtrain, eval = dtest)
#dtrain<-xgb.DMatrix(as.matrix(Train1)),label = target_2015
#dtest<-xgb.DMatrix(as.matrix(test1))
#y_train<-test[,3]
#y_train
bst<-xgboost(data = dtrain,
label =as.numeric(Train1$target_2015),max_depth =4,eta = 1,nthread = 2,nrounds = 10,objective = "reg:linear")
#dtrain<-xgb.DMatrix(as.matrix(Train1)),label = target_2015
#dtest<-xgb.DMatrix(as.matrix(test1))
#y_train<-test[,3]
#y_train
bst<-xgboost(data = dtrain,
label =as.numeric(Train1$target_2015),max_depth =4,eta = 1,nthread = 2,nrounds = 10,objective = "reg:linear")
target_2019 <-predict(bst,dtest)
target_2019= round(target_2019,3)
head(target_2019)
target_2019 <-predict(bst,dtest)
target_2019= round(target_2019,3)
head(target_2019)
#dtrain<-xgb.DMatrix(as.matrix(Train1)),label = target_2015
#dtest<-xgb.DMatrix(as.matrix(test1))
#y_train<-test[,3]
#y_train
bst<-xgboost(data = dtrain,
label =as.numeric(Train1$target_2015),max_depth =4,eta = 1,nthread = 2,nrounds = 10,objective = "reg:linear")
target_20191 <-predict(bst,dtest)
target_20191= round(target_2019,3)
head(target_2019)
head(target_20191)
tail(target_20191)
target_2019 <-predict(bst,dtest)
target_2019= round(target_2019,3)
tail(target_20191)
target_2019
Square_ID= test[,23]
sub<-cbind(Square_ID,target_2019)
write.csv(sub,file = "SampleSubmission.csv",row.names = F)
SampleSubmission.csv<-read.csv("SampleSubmission.csv",header = T)
view(SampleSubmission.csv)
#dtrain<-xgb.DMatrix(as.matrix(Train1)),label = target_2015
#dtest<-xgb.DMatrix(as.matrix(test1))
#y_train<-test[,3]
#y_train
bst<-xgboost(data = dtrain,
label =as.numeric(Train1$target_2015),max_depth =4,eta = 1,nthread = 2,nrounds = 10,objective = "reg:linear")
target_2019 <-predict(bst,dtest)
target_2019= round(target_2019,3)
tail(target_20191)
Square_ID= test[,23]
sub<-cbind(Square_ID,target_2019)
write.csv(sub,file = "SampleSubmission.csv",row.names = F)
SampleSubmission.csv<-read.csv("SampleSubmission.csv",header = T)
view(SampleSubmission.csv)
```
library(readr)
SampleSubmission <- read_csv("SampleSubmission.csv")
View(SampleSubmission)
